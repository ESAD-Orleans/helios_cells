<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>iPad interface spacebrew helios cells </title>
	<script src="jquery-1.11.2.min.js" type="text/javascript"></script>
	<script src="sb-1.4.1.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function(){

			var map = $('#map');

			// change with server IP address
			var SERVER = '192.168.2.239',
				CLIENT_NAME = 'interface',
				CLIENT_DESCRIPTION = 'send touch position',
				PORT = 9000;

			var spacebrewClient = new Spacebrew.Client(SERVER,CLIENT_NAME, CLIENT_DESCRIPTION, PORT);

			spacebrewClient.addPublish('sendPosition','string','unknow position');
			spacebrewClient.addSubscribe('sendPosition','string');
			spacebrewClient.onOpen = function(){
				$('body').addClass('open');
			};
			spacebrewClient.onClose = function(){
				$('body').removeClass('open');
			};
			spacebrewClient.connect();

			function SendPosition(x,y){
				var position = {
					x: x,
					y: y,
					timestamp: Date.now()
				};
				spacebrewClient.send('sendPosition', 'string', JSON.stringify(position));
			}

			map.on('mousemove',function(e){
				SendPosition(e.offsetX, e.offsetY)
			});
			$(document).on('touchmove',function(e){
				var oEvent = e.originalEvent, touch = oEvent.touches[0], oX = map.offset().left, oY = map.offset().top,
						x = touch.pageX - oX,
						y = touch.pageY - oY;
				if(x<0 || x> 320 || y<0 || y>320){
					return false;
				}
				console.log(x,y);
				SendPosition(x,y);
				return false;
			});
		})
	</script>
	<style>
		html,body{
			background: darkorange;
			height:100vh;
			width:100vw;
			padding: 0;
			margin: 0;
			overflow: hidden;
		}
		body.open{
			background: #000;
		}
		#map{
			background: #fff;
			position:absolute;
			top:0;
			left:0;
			bottom:0;
			right:0;
			margin: auto;
		}
	</style>
</head>
<body>
<svg id="map" width="320" height="320">

</svg>
</body>
</html>